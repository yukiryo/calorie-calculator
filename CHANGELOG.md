# 更新日志 (Changelog)

## [1.0.4] - 2025-12-09

### ✨ 新增功能 (Features)
- **自定义输入弹窗**: 使用毛玻璃风格的自定义模态框替代原生 `prompt()`，确保存储食品名称时的视觉体验与整体 UI 保持一致。
- **自定义食品库**: 新增"常用食品"功能，支持保存自定义食品的能量值，点击标签一键填充，支持删除操作。数据保存于本地存储。
- **输入限制**: 输入框现在只允许输入数字和小数点，阻止负号、字母等非法字符输入，同时过滤粘贴内容。

### 🐛 修复 (Fixes)
- **自定义弹窗**: 修复了点击保存按钮时弹窗无法显示的问题（添加了缺失的激活类）。
- **图标白角**: 修复 iOS 添加到主屏幕时图标四角出现白色的问题（填充背景色）。
- **UI 对齐**: 修复历史记录列表与总计框宽度不一致的问题。

### 🧹 代码清理
- 移除 `main.ts` 中约30行冗余注释和废弃代码。
- 移除 `style.css` 中15处重复注释。

### ⚡ 代码优化
- 重构 `main.ts`：提取模式配置为 `MODE_CONFIG` 常量对象，简化 `toggleMode` 函数。
- 简化 `calculate` 函数，使用三元运算符替代 if-else。
- 移动 import 语句到文件顶部。

## [1.0.3] - 2025-12-09

### ✨ 新增功能 (Features)
- **一席总计 (Meal Total)**: 新增"加入记录"功能，支持多次计算结果累加求和，并提供一键清空记录选项。
- **公式文案**: 更新底部计算公式显示，使其更符合中文语境和数学逻辑，方便用户理解计算过程。
- **PWA 智能滚动**: 优化滚动体验，当内容不足一屏时禁止页面回弹 (Rubber-band effect)，内容超出时自动开启原生滚动，完美解决内容被遮挡问题。
- **应用内更新日志**: 页面底部新增更新日志入口，自动解析并展示 `CHANGELOG.md` 内容，无需离开应用即可查看版本历史。
- **Favicon**: 为浏览器标签页添加了与 App 一致的图标。

### 🐛 修复 (Fixes)
- **TypeScript**: 修复 `*.md?raw` 导入导致的类型报错。
- **Input 样式**: 修复 `input[type=number]` 在不同浏览器下的显示兼容性问题。
- **文档**: 更新中英文 README，补充新功能说明。

## [1.0.2] - 2025-12-08

### 💄 样式优化
- **移动端适配**: 使用 `100dvh` 替换 `100vh`，解决移动端浏览器地址栏遮挡底部内容的问题。

## [1.0.1] - 2025-12-08

### 🐛 修复 (Fixes)
- **iOS 图标**: 修复添加到主屏幕时图标显示异常的问题，采用实心背景图标防止白边。
- **全屏显示**: 修复 iOS Safari 上下滑动时出现的白边问题 (添加 `viewport-fit=cover`)。

## [1.0.0] - 2025-12-08

### ✨ 新增功能 (Features)
- **核心计算**: 支持输入食品重量 (g) 和能量密度 (kJ/100g)，自动计算总热量 (kcal)。
- **单位切换**: 新增双向切换开关，支持 `kJ -> kcal` 和 `kcal -> kJ` 两种计算模式。
- **PWA 支持**: 集成 `vite-plugin-pwa`，支持安装到手机桌面，离线可用。
- **深色模式**: 默认采用高级深色毛玻璃 (Glassmorphism) UI 设计。

### 💄 界面优化 (UI/UX)
- **响应式设计**: 完美适配桌面端、平板和移动端设备。
- **动态交互**: 输入时自动计算，结果带有缩放动画。
- **智能排版**: 使用 Fluid Typography (流体排版) 确保文字在不同屏幕下的可读性。

### 🔧 工程化
- 使用 Vite + TypeScript 构建。
- 配置 Cloudflare Pages 部署流程。
- 包含完整的各种尺寸 PWA 图标。
