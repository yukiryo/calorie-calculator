# 更新日志

## [1.0.8] - 2024-12-20

### 新增
- **Supabase 集成**: 集成 Supabase 配置并简化云同步流程
- **自定义提示框**: 替换原生 alert 为 Glassmorphism 风格模态框

### 变更
- **项目清理**: 移除冗余文档与依赖，增强推送脚本稳定性
- **按钮统一**: 统一所有弹窗按钮（登录、注册、同步、确认等）的尺寸和样式
- **iOS 状态栏**: 恢复 theme-color 以适配 iOS 状态栏背景色
- **类型安全**: 改进 TypeScript 类型安全和云端编辑同步

### 修复
- **登录持久化**: 显式配置 Supabase 会话持久化和自动刷新，解决登录状态频繁丢失
- **iOS 模态框**: 重构模态框逻辑，使用 `visibility` 代替 `display: none` 彻底修复渲染问题
- **iOS 模态框**: 使用强制重排修复第二次打开弹窗无内容的问题
- **云同步弹窗**: 修复 iOS 上第二次点击无法显示弹窗的问题
- **弹窗层级**: 修复登录成功弹窗被登录窗口遮挡的问题
- **构建修复**: 解决因重复函数声明导致的构建失败
- **iOS 状态栏**: 修复 iOS PWA 状态栏不沉浸问题

---

## [1.0.7] - 2024-12-11

### 新增
- **版本号显示**: 在页面底部 footer 显示当前应用版本号，随 package.json 自动同步

### 变更
- **副标题更新**: 更新为「kJ 和 kcal 之间精准换算」
- **云朵图标**: 修复按钮内图标不居中问题，使用标准 viewBox

### 修复
- **网页端链接**: 修复网页端更新日志链接点击问题
- **弹窗体验**: 修复登录/注册成功后云同步设置窗口未关闭的问题
- **注销功能**: 修复注销按钮点击无反应的问题
- **输入干扰**: 修复摄入量输入框被错误识别为密码框的问题
- **邮件验证**: 修正注册验证邮件的跳转链接
- **弹窗体验**: 调整所有弹窗的关闭按钮位置至右上角
- **UI 统一**: 统一云同步设置和登录窗口的按钮颜色与输入框样式
- **弹窗重构**: 全面替换浏览器原生 alert 弹窗为自定义玻璃拟态弹窗

---

## [1.0.6] - 2024-12-10

### 修复
- **版本号修正**: 修正前次推送的版本号混乱问题
- **自动填充**: 紧急修复浏览器自动填充导致的输入框样式异常

---

## [1.0.5] - 2024-12-10

### 新增
- **云端同步**: 集成 Supabase 实现多设备数据同步
- **用户认证**: 支持邮箱注册/登录，自动保持登录状态
- **智能合并**: 采用「智能合并」策略，自动保留离线添加的数据

### 修复
- **UI 优化**: 修复图标对齐和未登录时的显示状态

---

## [1.0.4] - 2024-12-10

### 新增
- **智能食品库**: 食品库显示单位，点击自动切换模式并填充
- **公式标准化**: 优化底部辅助公式为 `Total kcal = (kJ/100g × Weight) ÷ 418.4`
- **食品库编辑**: 支持编辑已保存的常用食品
- **自定义弹窗**: 毛玻璃风格模态框替代原生弹窗
- **输入限制**: 只允许输入数字和小数点

### 变更
- **食品库抽屉**: 改为底部抽屉模式 (Bottom Sheet)
- **代码清理**: 移除约 45 行冗余代码
- **逻辑重构**: 提取模式配置为 `MODE_CONFIG` 常量

### 修复
- **单位显示**: 修复 CSS 大写导致单位显示错误
- **PWA 更新**: 优化 iOS 端更新策略
- **抽屉适配**: 限制电脑端抽屉宽度为 480px

---

## [1.0.3] - 2024-12-09

### 新增
- **一席总计**: 新增「加入记录」功能，支持多次计算累加求和
- **应用内更新日志**: 页面底部新增更新日志入口
- **PWA 智能滚动**: 优化滚动体验，解决内容被遮挡问题
- **Favicon**: 添加浏览器标签页图标

### 修复
- **TypeScript**: 修复 `*.md?raw` 导入类型报错
- **Input 样式**: 修复不同浏览器显示兼容性问题

---

## [1.0.2] - 2024-12-08

### 变更
- **移动端适配**: 使用 `100dvh` 解决地址栏遮挡问题

---

## [1.0.1] - 2024-12-08

### 修复
- **iOS 图标**: 修复添加到主屏幕时图标显示异常
- **全屏显示**: 修复 iOS Safari 白边问题

---

## [1.0.0] - 2024-12-08

### 新增
- **核心计算**: 支持输入食品重量和能量密度，自动计算总热量
- **单位切换**: 支持 kJ ↔ kcal 双向计算
- **PWA 支持**: 可安装到桌面，离线可用
- **深色模式**: 高级毛玻璃 (Glassmorphism) UI 设计

### 变更
- **响应式设计**: 完美适配桌面端、平板和移动端
- **动态交互**: 输入时自动计算，结果带缩放动画

[1.0.8]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.7...v1.0.8
[1.0.7]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.6...v1.0.7
[1.0.6]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.5...v1.0.6
[1.0.5]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.4...v1.0.5
[1.0.4]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.3...v1.0.4
[1.0.3]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.2...v1.0.3
[1.0.2]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.1...v1.0.2
[1.0.1]: https://github.com/yukiryo/calorie-calculator/compare/v1.0.0...v1.0.1
[1.0.0]: https://github.com/yukiryo/calorie-calculator/releases/tag/v1.0.0
